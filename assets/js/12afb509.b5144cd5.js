"use strict";(self.webpackChunkadguard_dns_knowledge_base=self.webpackChunkadguard_dns_knowledge_base||[]).push([[145],{5680:(e,t,n)=>{n.d(t,{xA:()=>c,yg:()=>y});var a=n(6540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),d=r,y=u["".concat(l,".").concat(d)]||u[d]||m[d]||o;return n?a.createElement(y,i(i({ref:t},c),{},{components:n})):a.createElement(y,i({ref:t},c))}));function y(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:r,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1348:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var a=n(9668),r=(n(6540),n(5680));const o={},i="How to create your own DNS stamp for Secure DNS",s={unversionedId:"miscellaneous/create-dns-stamp",id:"miscellaneous/create-dns-stamp",title:"How to create your own DNS stamp for Secure DNS",description:"This guide will show you how to create your own DNS stamp for Secure DNS. Secure DNS is a service that enhances your internet security and privacy by encrypting your DNS queries. This prevents your queries from being intercepted or manipulated by malicious actors.",source:"@site/docs/miscellaneous/create-dns-stamp.md",sourceDirName:"miscellaneous",slug:"/miscellaneous/create-dns-stamp",permalink:"/KnowledgeBaseDNS/miscellaneous/create-dns-stamp",draft:!1,editUrl:"https://github.com/AdguardTeam/KnowledgeBaseDNS/edit/master/docs/miscellaneous/create-dns-stamp.md",tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"Credits and Acknowledgements",permalink:"/KnowledgeBaseDNS/miscellaneous/acknowledgements"}},l={},p=[{value:"Introduction to DNS stamps",id:"introduction-to-dns-stamps",level:2},{value:"Choosing the protocol",id:"choosing-the-protocol",level:2},{value:"Creating a DNS stamp",id:"creating-a-dns-stamp",level:2},{value:"Obtaining the certificate hash",id:"obtaining-the-certificate-hash",level:3},{value:"Using the DNS stamp",id:"using-the-dns-stamp",level:2},{value:"Example of creating a DNS stamp",id:"example-of-creating-a-dns-stamp",level:2}],c={toc:p},u="wrapper";function m(e){let{components:t,...n}=e;return(0,r.yg)(u,(0,a.A)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"how-to-create-your-own-dns-stamp-for-secure-dns"},"How to create your own DNS stamp for Secure DNS"),(0,r.yg)("p",null,"This guide will show you how to create your own DNS stamp for Secure DNS. Secure DNS is a service that enhances your internet security and privacy by encrypting your DNS queries. This prevents your queries from being intercepted or manipulated by malicious actors."),(0,r.yg)("p",null,"Secure DNS usually uses ",(0,r.yg)("inlineCode",{parentName:"p"},"tls://"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"https://")," or ",(0,r.yg)("inlineCode",{parentName:"p"},"quic://")," URLs. This is sufficient for most users and is the recommended way."),(0,r.yg)("p",null,"However, if you need additional security, like pre-resolved server IPs and certificate pinning by hash, you may generate your own DNS stamp."),(0,r.yg)("h2",{id:"introduction-to-dns-stamps"},"Introduction to DNS stamps"),(0,r.yg)("p",null,"DNS stamps are short strings that contain all the information needed to connect to a secure DNS server. They simplify the process of setting up Secure DNS as the user does not need to manually enter all this data."),(0,r.yg)("p",null,"DNS stamps allow you to customize Secure DNS settings beyond the usual URLs. In particular, they allow you to specify hard-coded server addresses, use certificate hashing, and so on. These features make DNS stamps a more robust and versatile option for configuring Secure DNS settings."),(0,r.yg)("h2",{id:"choosing-the-protocol"},"Choosing the protocol"),(0,r.yg)("p",null,"Types of Secure DNS include ",(0,r.yg)("inlineCode",{parentName:"p"},"DNS-over-HTTPS (DoH)"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"DNS-over-QUIC (DoQ)"),", and ",(0,r.yg)("inlineCode",{parentName:"p"},"DNS-over-TLS (DoT)")," and some others. Choosing one of these protocols depends on the context in which you'll be using them."),(0,r.yg)("h2",{id:"creating-a-dns-stamp"},"Creating a DNS stamp"),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Open the ",(0,r.yg)("a",{parentName:"p",href:"https://dnscrypt.info/stamps/"},"DNSCrypt Stamp Calculator"),".")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Depending on the chosen protocol, select the corresponding protocol from the dropdown menu (DoH, DoT, or DoQ).")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Fill in the necessary fields:"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"IP address"),":\nEnter the IP address of the DNS server. If you are using the DoT or DoQ protocol, make sure that you have specified the appropriate port as well.")),(0,r.yg)("admonition",{parentName:"li",type:"note"},(0,r.yg)("p",{parentName:"admonition"},"This field is optional and should be used with caution: using this option may disrupt the Internet on IPv6-only networks.")),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Hashes"),":\nEnter the SHA256 digest of one of the TBS certificates found in the validation chain. If the DNS server you are using provides a ready-made hash, find and copy it. Otherwise, you can obtain it by following the instructions in the ",(0,r.yg)("a",{parentName:"li",href:"#obtaining-the-certificate-hash"},(0,r.yg)("em",{parentName:"a"},"Obtaining the Certificate Hash"))," section.")),(0,r.yg)("admonition",{parentName:"li",type:"note"},(0,r.yg)("p",{parentName:"admonition"},"This field is optional")),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"Host name"),": Enter the host name of the DNS server. This field is used for server name verification in DoT and DoQ protocols.")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"For ",(0,r.yg)("strong",{parentName:"p"},"DoH"),":"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Path"),": Enter the path for performing DoH requests. This is usually ",(0,r.yg)("inlineCode",{parentName:"li"},'"/dns-query"'),", but your provider may provide a different path."))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"For ",(0,r.yg)("strong",{parentName:"p"},"DoT and DoQ"),":"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"There are usually no specific fields for these protocols in this tool. Just make sure the port specified in the resolver address is the correct port."))),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"In the ",(0,r.yg)("strong",{parentName:"p"},"Properties")," section, you can check the relevant properties if they are known and applicable to your DNS server.")))),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Your stamp will be automatically generated and you will see it in the ",(0,r.yg)("strong",{parentName:"p"},"Stamp")," field."))),(0,r.yg)("h3",{id:"obtaining-the-certificate-hash"},"Obtaining the certificate hash"),(0,r.yg)("p",null,"To fill in the ",(0,r.yg)("strong",{parentName:"p"},"Hashes of the server's certificate")," field, you can use the following command, replacing ",(0,r.yg)("inlineCode",{parentName:"p"},"<IP_ADDRESS>"),", ",(0,r.yg)("inlineCode",{parentName:"p"},"<PORT>"),", and ",(0,r.yg)("inlineCode",{parentName:"p"},"<SERVER_NAME>")," with the corresponding values for your DNS server:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"echo | openssl s_client -connect <IP_ADDRESS>:<PORT> -servername <SERVER_NAME> 2>/dev/null | openssl x509 -outform der | openssl asn1parse -inform der -strparse 4 -noout -out - | openssl dgst -sha256\n")),(0,r.yg)("admonition",{type:"caution"},(0,r.yg)("p",{parentName:"admonition"},"The result of the hash command may change over time as the server's certificate is updated. Therefore, if your DNS stamp suddenly stops working, you may need to recalculate the hash of the certificate and generate a new stamp. Regularly updating your DNS stamp will help ensure the continued secure operation of your Secure DNS service.")),(0,r.yg)("h2",{id:"using-the-dns-stamp"},"Using the DNS stamp"),(0,r.yg)("p",null,"You now have your own DNS stamp that you can use to set up Secure DNS. This stamp can be entered into AdGuard and AdGuard VPN for enhanced internet privacy and security."),(0,r.yg)("h2",{id:"example-of-creating-a-dns-stamp"},"Example of creating a DNS stamp"),(0,r.yg)("p",null,"Let's go through an example of creating a stamp for AdGuard DNS using DoT:"),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Open the ",(0,r.yg)("a",{parentName:"p",href:"https://dnscrypt.info/stamps/"},"DNSCrypt Stamp Calculator"),".")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Select the DNS-over-TLS (DoT) protocol.")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Fill in the following fields:"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"IP address"),": Enter the IP address and port of the DNS server. In this case, it's ",(0,r.yg)("inlineCode",{parentName:"p"},"94.140.14.14:853"),".")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"Host name"),": Enter the host name of the DNS server. In this case, it's ",(0,r.yg)("inlineCode",{parentName:"p"},"dns.adguard-dns.com"),".")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},"Hashes"),":\nExecute the command"))),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"echo | openssl s_client -connect 94.140.14.14:853 -servername dns.adguard-dns.com 2>/dev/null | openssl x509 -outform der | openssl asn1parse -inform der -strparse 4 -noout -out - | openssl dgst -sha256\n")),(0,r.yg)("p",{parentName:"li"},"The result is ",(0,r.yg)("inlineCode",{parentName:"p"},"1ebea9685d57a3063c427ac4f0983f34e73c129b06e7e7705640cacd40c371c8"),"\nPaste this SHA256 hash of the server's certificate into the field.")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Leave the Properties section blank.")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Your stamp will be automatically generated and you will see it in the ",(0,r.yg)("strong",{parentName:"p"},"Stamp")," field."))))}m.isMDXComponent=!0}}]);